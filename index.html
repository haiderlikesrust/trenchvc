<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRENCH VC</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="server-info">
                <h1>TRENCH VC</h1>
                <div class="status-indicator" id="status">
                    <span class="status-dot"></span>
                    <span id="status-text">Connecting...</span>
                </div>
            </div>
            <div class="room-info">
                <span class="room-topic" id="roomTopic">Late night alpha talk</span>
                <span class="room-timer" id="roomTimer">00:00</span>
                <span class="room-status public" id="roomStatus" title="Public Room">üåê</span>
            </div>
            <div class="top-controls">
                <button id="inviteBtn" class="icon-btn" title="Copy Invite Link">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                </button>
                <button id="settingsBtn" class="icon-btn" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Test Mic Modal -->
        <div class="modal" id="testMicModal">
            <div class="modal-content">
                <h2>Test Your Microphone</h2>
                <div class="mic-test-section">
                    <button id="testMicBtn" class="btn btn-primary">
                        <span class="btn-icon">üéôÔ∏è</span>
                        <span class="btn-text">Test Mic</span>
                    </button>
                    <div class="audio-visualizer" id="audioVisualizer">
                        <div class="visualizer-bar"></div>
                        <div class="visualizer-bar"></div>
                        <div class="visualizer-bar"></div>
                        <div class="visualizer-bar"></div>
                        <div class="visualizer-bar"></div>
                        <div class="visualizer-bar"></div>
                        <div class="visualizer-bar"></div>
                        <div class="visualizer-bar"></div>
                    </div>
                    <div class="mic-level-info">
                        <span id="micLevelText">Mic Level: 0%</span>
                    </div>
                    <div class="modal-actions">
                        <button id="joinVcBtn" class="btn btn-success" style="display: none;">
                            Join Voice Channel
                        </button>
                        <button id="closeTestModalBtn" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div class="modal" id="settingsModal" style="display: none;">
            <div class="modal-content">
                <h2>Audio Settings</h2>
                <div class="settings-panel">
                    <div class="setting-item">
                        <label for="volumeSlider">Output Volume</label>
                        <div class="slider-container">
                            <input type="range" id="volumeSlider" min="0" max="100" value="100" class="slider">
                            <span id="volumeValue">100%</span>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="inputGainSlider">Microphone Gain</label>
                        <div class="slider-container">
                            <input type="range" id="inputGainSlider" min="0" max="200" value="100" class="slider">
                            <span id="inputGainValue">100%</span>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="audioDeviceSelect">Audio Input Device</label>
                        <select id="audioDeviceSelect" class="device-select">
                            <option value="">Default</option>
                        </select>
                    </div>
                    <div class="setting-item checkbox-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="echoCancellation" checked>
                            <span>Echo Cancellation</span>
                        </label>
                    </div>
                    <div class="setting-item checkbox-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="noiseSuppression" checked>
                            <span>Noise Suppression</span>
                        </label>
                    </div>
                    <div class="setting-item checkbox-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="autoGainControl" checked>
                            <span>Auto Gain Control</span>
                        </label>
                    </div>
                    <button id="closeSettingsBtn" class="btn btn-secondary">Close</button>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Active Speaker Visualization -->
            <div class="active-speaker-viz" id="activeSpeakerViz" style="display: none;">
                <div class="speaker-waveform" id="speakerWaveform">
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                </div>
                <div class="speaker-info">
                    <div class="speaker-name" id="activeSpeakerName">-</div>
                    <div class="speaker-status" id="activeSpeakerStatus">Speaking</div>
                </div>
            </div>

            <!-- Empty State -->
            <div class="empty-state" id="emptyState">
                <div class="empty-message">
                    <div class="empty-icon">üé§</div>
                    <h2>Waiting for others to join</h2>
                    <p>The trench is quiet... for now</p>
                </div>
                <div class="ambient-visualization">
                    <div class="ambient-ring"></div>
                    <div class="ambient-ring"></div>
                    <div class="ambient-ring"></div>
                </div>
            </div>

            <!-- Participants Grid -->
            <div class="participants-grid" id="participantsGrid">
                <!-- Participants will be added dynamically -->
            </div>

            <!-- Ghost Slots -->
            <div class="ghost-slots" id="ghostSlots">
                <!-- Ghost avatars will be added dynamically -->
            </div>

            <!-- Info Bar -->
            <div class="info-bar">
                <div class="info-item">
                    <span class="info-label">Participants:</span>
                    <span class="info-value" id="peopleCount">0</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Quality:</span>
                    <span class="info-value" id="connectionQuality">-</span>
                </div>
            </div>
        </div>

        <!-- Bottom Controls Bar -->
        <div class="bottom-controls" id="mainControls" style="display: none;">
            <div class="control-left">
                <div class="mic-meter-container">
                    <div class="mic-meter-label">Mic</div>
                    <div class="mic-meter-bar">
                        <div class="mic-meter-fill" id="micMeterFill"></div>
                    </div>
                </div>
                <div class="quality-indicators">
                    <div class="quality-item" id="pingIndicator" title="Latency">
                        <span class="quality-icon">üì°</span>
                        <span class="quality-value" id="pingValue">-</span>
                    </div>
                    <div class="quality-item" id="voiceQualityIndicator" title="Voice Quality">
                        <span class="quality-icon" id="voiceQualityIcon">üî•</span>
                        <span class="quality-value" id="voiceQualityText">Good</span>
                    </div>
                </div>
            </div>
            <div class="control-center">
                <button id="muteBtn" class="control-btn mute-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7H17"></path>
                    </svg>
                    <span>Mute</span>
                </button>
                <button id="leaveBtn" class="control-btn leave-btn" data-confirm-delay="2000">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    <span>Leave</span>
                </button>
            </div>
            <div class="control-right">
                <button id="expandSettingsBtn" class="control-btn expand-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Join Button (shown when not in VC) -->
        <div class="join-prompt" id="joinPrompt">
            <button id="showTestModalBtn" class="btn btn-primary btn-large">
                Join Voice Channel
            </button>
        </div>
    </div>
    
    <script src="client.js"></script>
</body>
</html>
